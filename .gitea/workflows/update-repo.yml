name: Update Repository
runs-on: home-server
on:
  workflow_call:
jobs:
  update-repo-folder:
    steps:
      - name: checkout repo
        working-directory: /home/gitea-runner
        run: |
          if [ -d "infrastructure" ]; then
            cd infrastructure
            echo "Infrastructure folder exists. Resetting to the most recent commit."
            git reset --hard HEAD
            git pull https://x-access-token:${{ secrets.GITEA_TOKEN }}@git.alexmickelson.guru/${{ gitea.repository }} $(git rev-parse --abbrev-ref HEAD)
          else
            git clone https://x-access-token:${{ secrets.GITEA_TOKEN }}@git.alexmickelson.guru/${{ gitea.repository }}.git
          fi
